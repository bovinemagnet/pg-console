# PostgreSQL configuration
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=${POSTGRES_URL:jdbc:postgresql://localhost:5432/postgres}
quarkus.datasource.username=${POSTGRES_USER:postgres}
quarkus.datasource.password=${POSTGRES_PASSWORD:postgres}

# HTTP Configuration
quarkus.http.port=8080
quarkus.http.host=0.0.0.0

# Qute Configuration
quarkus.qute.content-types.css=text/css;charset=utf-8
quarkus.qute.content-types.js=application/javascript;charset=utf-8

# Logging
quarkus.log.level=INFO
quarkus.log.console.enable=true
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] %s%e%n

# Application metadata
quarkus.application.name=pg-console
quarkus.application.version=1.0.0

# Database filter - comma-separated list of database names to monitor
# Leave unset or omit to show all non-template databases
# Examples:
#   pg-console.databases=postgres,myapp_prod
#   pg-console.databases=sim_prd_eplus
# Can also be set via environment variable: PG_CONSOLE_DATABASES
#pg-console.databases=

# Flyway Configuration
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.schemas=pgconsole

# History Sampling Configuration
pg-console.history.enabled=${PG_CONSOLE_HISTORY_ENABLED:true}
pg-console.history.interval-seconds=${PG_CONSOLE_HISTORY_INTERVAL:60}
pg-console.history.retention-days=${PG_CONSOLE_HISTORY_RETENTION:7}
pg-console.history.top-queries=${PG_CONSOLE_HISTORY_TOP_QUERIES:50}

# Multi-Instance Configuration
# Comma-separated list of instance names (first one is the default)
# pg-console.instances=default,production,staging
pg-console.instances=${PG_CONSOLE_INSTANCES:default}

# Display names for instances (optional, defaults to instance name)
# pg-console.instance.production.display-name=Production DB
# pg-console.instance.staging.display-name=Staging DB

# Named datasources for additional instances:
# quarkus.datasource.production.db-kind=postgresql
# quarkus.datasource.production.jdbc.url=${POSTGRES_PRODUCTION_URL}
# quarkus.datasource.production.username=${POSTGRES_PRODUCTION_USER}
# quarkus.datasource.production.password=${POSTGRES_PRODUCTION_PASSWORD}

# Security Configuration
# Set to true to enable HTTP Basic authentication
pg-console.security.enabled=${PG_CONSOLE_SECURITY_ENABLED:false}

# Properties file authentication (when security is enabled)
quarkus.security.users.file.enabled=${pg-console.security.enabled}
quarkus.security.users.file.plain-text=true
quarkus.security.users.file.users=users.properties
quarkus.security.users.file.roles=roles.properties

# HTTP Basic Authentication (only enabled when security is enabled)
quarkus.http.auth.basic=${pg-console.security.enabled}

# Admin-only endpoints require admin role when security is enabled
quarkus.http.auth.permission.admin-actions.paths=/api/activity/*/cancel,/api/activity/*/terminate
quarkus.http.auth.permission.admin-actions.policy=role-policy-admin
quarkus.http.auth.permission.admin-actions.methods=POST
quarkus.http.auth.permission.admin-actions.enabled=${pg-console.security.enabled}

# Role policy requiring admin role
quarkus.http.auth.policy.role-policy-admin.roles-allowed=admin

# Development profile: disable security by default
%dev.pg-console.security.enabled=false
