{#include base}
{#title}Table Statistics - PostgreSQL Console{/title}
{#insert}
<div class="row mt-4">
    <div class="col-12">
        <h1>Table Statistics</h1>
        <p class="text-muted">Table and index usage with bloat indicators</p>
    </div>
</div>

<div class="row mt-3">
    <div class="col-12">
        {#if tables.isEmpty()}
        <div class="alert alert-info">
            No user tables found in the database.
        </div>
        {#else}
        <div class="table-responsive">
            <table class="table table-striped table-hover table-sm">
                <thead>
                    <tr>
                        <th>Schema</th>
                        <th>Table</th>
                        <th>Seq Scans</th>
                        <th>Index Scans</th>
                        <th>Inserts</th>
                        <th>Updates</th>
                        <th>Deletes</th>
                        <th>Live Tuples</th>
                        <th>Dead Tuples</th>
                        <th>Bloat %</th>
                    </tr>
                </thead>
                <tbody>
                    {#for table in tables}
                    <tr {#if table.bloatRatio > 20}class="table-warning"{/if}>
                        <td>{table.schemaName}</td>
                        <td>{table.tableName}</td>
                        <td>{table.seqScan}</td>
                        <td>{table.idxScan}</td>
                        <td>{table.nTupIns}</td>
                        <td>{table.nTupUpd}</td>
                        <td>{table.nTupDel}</td>
                        <td>{table.nLiveTup}</td>
                        <td>{table.nDeadTup}</td>
                        <td>
                            {#if table.bloatRatio > 20}
                                <span class="badge bg-warning">{table.bloatRatio}%</span>
                            {#else if table.bloatRatio > 10}
                                <span class="badge bg-info">{table.bloatRatio}%</span>
                            {#else}
                                <span class="badge bg-success">{table.bloatRatio}%</span>
                            {/if}
                        </td>
                    </tr>
                    {/for}
                </tbody>
            </table>
        </div>
        {/if}
    </div>
</div>
{/insert}
{/include}
